<!DOCTYPE html>
<html>
  <head>
    <title>WMTS</title>
    <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css" type="text/css">
    <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>

    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <link rel="stylesheet" href="https://openlayers.org/en/latest/css/ol.css" />
    <script type="text/javascript" src="https://openlayers.org/en/latest/build/ol.js"></script>
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL,Object.assign"></script>

    <!-- ol-ext -->
    <link rel="stylesheet" href="ol-ext.css" />
    <script type="text/javascript" src="ol-ext.js"></script>

  </head>
  <body>

	<!-- Map div -->
	<div id="map" style="width:100%; height:512px;"></div>

	<script type="text/javascript">
      function newWTMSLayer(url, layer){
	return new ol.layer.Tile({
        title: layer,
	source: new ol.source.WMTS({
              attributions: 'Remi CRESSON / UMR TETIS / IRSTEA',
              url: url,
              layer: layer,
              baseLayer: true,
              matrixSet: 'EPSG:3857',
              format: 'image/png',
              projection: projection,
              tileGrid: new ol.tilegrid.WMTS({
                origin: ol.extent.getTopLeft(projectionExtent),
                resolutions: resolutions,
                matrixIds: matrixIds
              }),
              style: 'default',
              wrapX: true
            })
	});
      };

      var projection = new ol.proj.get('EPSG:3857');
      var projectionExtent = projection.getExtent();
      var size = ol.extent.getWidth(projectionExtent) / 256;
      var nRes = 18
      var resolutions = new Array(nRes);
      var matrixIds = new Array(nRes);
      for (var z = 0; z < nRes; ++z) {
        // generate resolutions and matrixIds arrays for this WMTS
        resolutions[z] = size / Math.pow(2, z);
        matrixIds[z] = z;
      }

		// Layers
		var label = newWTMSLayer('https://mdl4eo-cartes.irstea.fr/index.php/lizmap/service/?repository=supresol&project=super_resolution_v2', 'Original S2 image ');
		var label2 = newWTMSLayer('https://mdl4eo-cartes.irstea.fr/index.php/lizmap/service/?repository=supresol&project=super_resolution_v2', 'High-res S2 image');
                var patches = newWTMSLayer('https://mdl4eo-cartes.irstea.fr/index.php/lizmap/service/?repository=supresol&project=super_resolution', 'Training patches footprint');

		// The map
		var map = new ol.Map
			({	target: 'map',
				view: new ol.View
				({	zoom: 16,
					center: [453333, 5484830],
                                        minZoom: 10,
                                        maxZoom: nRes

				}),
			controls: ol.control.defaults().extend
			([	new ol.control.LayerPopup(),
			]),
				layers: [ label, label2, patches ]
			});

		// "Swipe" Control
		var ctrl = new ol.control.Swipe();
		map.addControl(ctrl);

		// Set stamen on left
		ctrl.addLayer(label);

		// OSM on right
		ctrl.addLayer(label2, true);

	</script>


  </body>
</html>
